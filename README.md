# Meowpunk-test

## How run

- склонируйте репозиторий на локальную машину
- добавьте исходные файлы задачи (дб и .csv) в папку `src/data` (они слишком большие чтобы загружать их на гитхаб)
- установите виртуальное окружение python командой `virtualenv -p python 3.10 venv`.
- активируййте вирутальное окружение и устновите зависимсоти через `pip install -r requirements.txt`
- запустите скрипт с помощью `python src/init_db.py`

Естественно это очень сырой продукт, сделанный в рамках тестового задания. Не гарантируется, что указанный выше путь приведет к успешному запуску проекта локально.

**Что сделано?**

1. реализован доступ к ДБ (я использую стандартный питоний sqlite3 коннектор. Конечно в здравом уме я бы не стал так делать на проде, но так быстрее всего в рамках задачи)
2. Создается новая таблица
3. Извлекаются данные из имеющейся таблицы и .csv файлов
4. Осуществляется обработка данных и выгрузка их в новую таблицу
5. Код причесан в flake8

Самая затратная по времени функция обрабатывает данные 10-12с. Это много, можно значительно лучше, но, ввиду ограниченности времени... увы.

Еще:

- кажется в задании ошибка - все временные метки из server.csv датируются 1970 годом, что лишает смысла задачу сравнения - они априори старше меток ban_time... ну или я не прави льно понял задачу
- файл research.ipynb использовался для исследовпния задачи. Вся логика - в папке src
- **Я не делал подвыборку по дате, так как в задаче нет четких указаний какие даты выбирать. К тому же (см. выше), возникли сомнения в корерктности данных таймсерий** Естественно внести изменеения не является проблемой.

## Task

Есть два csv файла client.csv и server.csv

В sqlite есть таблица cheaters.

Поля client.csv:

- timestamp
- player_id
- error_id
- json

Поля server.csv:

- timestamp
- event_id
- error_id
- json

Поля таблицы cheaters:

- player_id integer
- ban_time string

## Задача 1

Создать в sqlite пустую таблицу с полями

- timestamp
- player_id
- event_id
- error_id
- json_server
- json_client

## Задача 2

Написать класс или функцию, которая:

1. Выгрузит данные из client.csv и server.scv за определенную дату
2. Объединит данные из этих таблиц по error_id
3. Исключить из выборки записи с player_id, которые есть в таблице  cheaters но только в том случае если у player_id ban_time - это предыдущие сутки или раньше относительно timestamp из server.scv
4. Выгрузит данные в таблицу, созданную в задаче 1. В ней должны бать следующие данные:

- timestamp из server.csv
- player_id из client.csv
- error_id  из сджойненных server.csv и client.csv
- json_server поле json из server.csv
- json_client поле json из client.csv

## Задача 3*

Замерить потребление памяти во время выполнения задачи

Можно использовать любые библиотеки

Можно гуглить

Большим плюсом является структурированность кода и соответствие PEP
